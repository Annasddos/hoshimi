
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üî• Gemini ChatBot Ultimate</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; font-family: 'Orbitron', sans-serif; }
    body { margin: 0; background: #000; color: #fff; height: 100vh; display: flex; flex-direction: column; }
    .hidden { display: none; }
    header { background: #111; padding: 15px; text-align: center; font-size: 1.4rem; color: #00e5ff; font-weight: bold; }
    #chatBox { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 12px; background: #0e0e0e; }
    .msg { max-width: 75%; padding: 10px 15px; border-radius: 15px; line-height: 1.5; animation: fadeIn 0.3s ease; word-wrap: break-word; }
    .user { align-self: flex-end; background: #1e88e5; }
    .bot { align-self: flex-start; background: #2e7d32; }
    .sender-label { font-size: 12px; opacity: 0.7; margin-bottom: 4px; }
    #inputArea { display: flex; gap: 10px; padding: 10px; background: #1a1a1a; }
    #messageInput { flex: 1; padding: 10px; border-radius: 10px; border: none; background: #2c2c2c; color: white; }
    button { padding: 10px 16px; border: none; border-radius: 10px; background: #00e5ff; color: black; font-weight: bold; cursor: pointer; }
    button:hover { background: #00c5d4; }
    .panel, .login-container, .register-container {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      height: 100vh; background: #000;
    }
    .box {
      background: #222; padding: 2rem; border-radius: 10px; box-shadow: 0 0 15px #00e5ff;
      width: 300px; text-align: center;
    }
    .box input { width: 100%; margin: 10px 0; padding: 10px; background: #333; border: none; border-radius: 5px; color: white; }
    .error { color: red; font-size: 13px; display: none; }
    #adminPanel table { width: 100%; color: white; margin-top: 20px; border-collapse: collapse; }
    #adminPanel td, #adminPanel th { border: 1px solid #888; padding: 8px; text-align: center; }
    #adminPanel th { background-color: #111; }
    @keyframes fadeIn { from {opacity: 0; transform: translateY(10px);} to {opacity: 1; transform: translateY(0);} }
  </style>
</head>
<body>

<!-- LOGIN PAGE -->
<div class="login-container" id="loginPage">
  <div class="box">
    <h2>Login</h2>
    <input type="text" id="loginUser" placeholder="Username">
    <input type="password" id="loginPass" placeholder="Password">
    <button onclick="login()">Masuk</button>
    <p><a href="#" onclick="showRegister()">Daftar Akun Baru</a></p>
    <p id="loginError" class="error">‚ùå Username / Password salah!</p>
  </div>
</div>

<!-- REGISTER PAGE -->
<div class="register-container hidden" id="registerPage">
  <div class="box">
    <h2>Daftar</h2>
    <input type="text" id="regUser" placeholder="Buat Username">
    <input type="password" id="regPass" placeholder="Buat Password">
    <button onclick="register()">Daftar</button>
    <p><a href="#" onclick="showLogin()">Kembali ke Login</a></p>
    <p id="registerError" class="error">‚ùå Username sudah digunakan!</p>
  </div>
</div>

<!-- ADMIN PANEL -->
<div class="panel hidden" id="adminPanel">
  <div class="box" style="width:80%;">
    <h2>üëë Admin Panel</h2>
    <table id="userTable">
      <thead><tr><th>Username</th><th>Status</th><th>Aksi</th></tr></thead>
      <tbody></tbody>
    </table>
    <p><button onclick="logout()">Logout</button></p>
  </div>
</div>

<!-- CHATBOT -->
<div class="hidden" id="chatApp" style="flex-direction:column; height:100vh;">
  <header>ü§ñ Gemini ChatBot Ultimate</header>
  <div id="chatBox"></div>
  <div id="inputArea">
    <input type="text" id="messageInput" placeholder="Tulis pesan...">
    <button onclick="sendMessage()">Kirim</button>
  </div>
</div>

<script>
  const DEFAULT_API_KEY = "AIzaSyBYmsmqVHHnio0i7TOLAXmYSsU3UNOhd3o";
  let currentUser = null;
  const suara = new SpeechSynthesisUtterance(); suara.lang = 'id-ID';

  const users = JSON.parse(localStorage.getItem("users") || "{}");

  function saveUsers() {
    localStorage.setItem("users", JSON.stringify(users));
  }

  function showRegister() {
    document.getElementById("loginPage").classList.add("hidden");
    document.getElementById("registerPage").classList.remove("hidden");
  }

  function showLogin() {
    document.getElementById("registerPage").classList.add("hidden");
    document.getElementById("loginPage").classList.remove("hidden");
  }

  function register() {
    const u = document.getElementById("regUser").value.trim();
    const p = document.getElementById("regPass").value;
    if (users[u]) {
      document.getElementById("registerError").style.display = "block";
      return;
    }
    users[u] = { password: p, premium: false };
    saveUsers();
    alert("‚úÖ Berhasil daftar! Silakan login.");
    showLogin();
  }

  function login() {
    const u = document.getElementById("loginUser").value.trim();
    const p = document.getElementById("loginPass").value;

    if (u === "annas" && p === "annas") {
      loadUserTable();
      document.getElementById("loginPage").classList.add("hidden");
      document.getElementById("adminPanel").classList.remove("hidden");
      return;
    }

    if (!users[u] || users[u].password !== p) {
      document.getElementById("loginError").style.display = "block";
      return;
    }

    currentUser = u;
    document.getElementById("loginPage").classList.add("hidden");
    document.getElementById("chatApp").classList.remove("hidden");
    loadHistory();
  }

  function logout() {
    location.reload();
  }

  function upgradeUser(username) {
    users[username].premium = true;
    saveUsers();
    loadUserTable();
  }

  function loadUserTable() {
    const tbody = document.querySelector("#userTable tbody");
    tbody.innerHTML = "";
    Object.keys(users).forEach(user => {
      const row = document.createElement("tr");
      row.innerHTML = `<td>${user}</td>
        <td>${users[user].premium ? 'Premium' : 'Gratis'}</td>
        <td>${users[user].premium ? '-' : `<button onclick="upgradeUser('${user}')">Setujui Premium</button>`}</td>`;
      tbody.appendChild(row);
    });
  }

  function renderMsg(sender, text) {
    const chatBox = document.getElementById("chatBox");
    const msg = document.createElement("div");
    msg.className = `msg ${sender}`;
    const label = document.createElement("div");
    label.className = "sender-label";
    label.textContent = sender === "user" ? currentUser : "Gemini";
    const body = document.createElement("div");
    body.innerHTML = text;
    msg.appendChild(label);
    msg.appendChild(body);
    chatBox.appendChild(msg);
    chatBox.scrollTop = chatBox.scrollHeight;
  }

  function saveHistory() {
    localStorage.setItem("chat_" + currentUser, document.getElementById("chatBox").innerHTML);
  }

  function loadHistory() {
    const saved = localStorage.getItem("chat_" + currentUser);
    if (saved) document.getElementById("chatBox").innerHTML = saved;
  }

  async function sendMessage() {
    const input = document.getElementById("messageInput");
    const teks = input.value.trim();
    if (!teks) return;
    renderMsg("user", teks);
    input.value = "";
    const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${DEFAULT_API_KEY}`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ contents: [{ parts: [{ text: teks }] }] })
    });
    const data = await res.json();
    const balasan = data?.candidates?.[0]?.content?.parts?.[0]?.text || "‚ö†Ô∏è Tidak ada balasan dari AI.";
    renderMsg("bot", balasan);
    suara.text = balasan;
    speechSynthesis.speak(suara);
    saveHistory();
  }

  document.getElementById("messageInput").addEventListener("keypress", e => {
    if (e.key === "Enter") sendMessage();
  });
</script>

</body>
</html>
